!function(t,s,a){"use strict";s.behaviors.tabsJS={attach:function(s,e){t(".cp-tabs").not(".is-shorcut, .popup-no-tabs").tabs(),t("body").hasClass("js-mobile")&&(t(".sub-tab__row").each((function(){let s=t(this),a=s.find(".sub-tab__content ol li"),e=a.length,i=a.slice(0,3);e>3&&(a.each((function(){t(this).hide()})),i.each((function(){t(this).show()})),s.children(".view-more").css("visibility","visible"))})),t(".component__tabs--contact").length>0&&t(".component__tabs--contact .cp-tabs .component__card").on("click",(function(){let s=t(this).children(".cta").children("a").attr("href");if(t(this).parents(".cp-tabs").hasClass("popup-no-tabs"))return a.location.replace(s),!1;t(this).parents(".cp-tabs").children(s).addClass("active")})));let i=function(t,s){t.find("option:eq(0)").attr("selected","selected").trigger("change"),t.triggerHandler("focus"),void 0!==s.find(".sub-tabs").tabs("instance")&&s.parents(".block-tabs-assistances, .block-tabs-documents-required").length>0&&s.find(".sub-tabs").tabs("destroy")};t((function(){let s=t("#tabs .component__heading ul li.ui-state-active a").attr("href"),a=t(s),e=a.find(".select--tabs");i(e,a)})),t(".cp-tabs ul li a").on("click",(function(s){if(!t(this).hasClass("popup-no-tabs")){let s=t(this),a=s.attr("href"),e=s.parents(".cp-tabs").children(a),o=e.find(".js-slider-mobile"),n=e.find(".select--tabs");n.length>0&&i(n,t(a)),o.length>0&&setTimeout((function(){o.find(".cog--items").slick("setPosition")}),10)}}));let o=function(t){let s,e,i=a.location.search.substring(1).split("&");for(e=0;e<i.length;e++)if(s=i[e].split("="),s[0]===t)return void 0===s[1]||decodeURIComponent(s[1])}("tab");void 0!==o&&t('a[href="#tabs-'+o+'"]').click(),t(".cp-tabs.is-shorcut .normal-tab a").on("click",(function(s){s.preventDefault(),t(".cp-tabs.is-shorcut .normal-tab a").removeClass("active"),t(this).addClass("active");let a=t(this).attr("href"),e=t(a).offset().top;console.log(e),t("html, body").stop(!0,!0).animate({scrollTop:t(a).offset().top-70},1e3)})),t(".select--tabs").change((function(){if(t(this).parent().parent().parent().parent().find(".sub-tab__container").length>0){t(this).parent().parent().parent().parent().find(".sub-tab__container").hide();let s=t(this).val();t("#"+s).show()}else t(".tabs").hide(),t("#"+t(this).val()).show()})),t(".component__tabs--contact").length>0&&(t(".component__tabs--contact .cp-tabs li").removeClass("ui-tabs-active ui-state-active"),t(".component__tabs--contact .cp-tabs li .component__card a").click((function(s){if(!t(this).hasClass("popup-no-tabs")){s.preventDefault(),t(this).parents(".component__tabs--contact .cp-tabs li").addClass("ui-tabs-active ui-state-active");let a=t(this).attr("href");a=a.substr(1),t(this).parents(".cp-tabs").find(".tabs").removeClass("active"),t(this).parents(".cp-tabs").find("#"+a).addClass("active")}})),t(".component__tabs--contact .cp-tabs .tabs form #close").click((function(s){t(this).parents(".tabs").removeClass("active")}))),t("#sub-tabs .component__heading").each((function(){let s=t(this);1===s.find(".select--tabs").find("option").length&&s.hide()})),t(".sub-tab__row .view-more").on("click",(function(s){s.preventDefault();let a=t(this).parents(".sub-tab__row");a.addClass("popup"),a.find(".sub-tab__heading-img").addClass("card__img--oval"),a.find(".sub-tab__content ol li").each((function(){t(this).show()}))})),t(".sub-tab__row .popup-close").on("click",(function(s){s.preventDefault();let a=t(this).parents(".sub-tab__row");a.find(".sub-tab__heading-img").removeClass("card__img--oval"),a.find(".sub-tab__content ol li").each((function(s){s>2&&t(this).hide()})),a.removeClass("popup")})),t((function(){let s=t(".is-shorcut .main-links");if(s.length>0){let e=Math.ceil(s.offset().top)-10;t(a).scroll((function(){t(a).scrollTop()>e?s.addClass("fixed").parent(".cog--mq").addClass("is-fixed").css("margin-bottom","5.25rem"):s.removeClass("fixed").parent(".cog--mq").removeClass("is-fixed").css("margin-bottom","")}))}})),t((function(){let s=t(".is-shorcut");s.length>0&&t(a).scroll((function(){s.find("div.tabs").each((function(){let e=t(this),i=e.attr("id"),o=Math.ceil(e.offset().top)-80;t(a).scrollTop()>o&&(s.find("a.active").removeClass("active"),s.find('a[href="#'+i+'"]').addClass("active"))}))}))})),t(".component__shorcuts .sticky-item a").on("click",(function(s){s.preventDefault(),t(".component__shorcuts .sticky-item, .component__shorcuts .sticky-item a").removeClass("active"),t(this).parent().addClass("active"),t(this).addClass("active");let a=t(this).attr("href"),e=t(a).offset().top;console.log(e),t("html, body").stop(!0,!0).animate({scrollTop:t(a).offset().top-70},1e3),s.stopPropagation()})),t((function(){let s=t(".component__shorcuts .sticky-wrapper");if(s.length>0){let e=Math.ceil(s.offset().top)+16;t(a).scroll((function(){t(a).scrollTop()>e?s.addClass("is-fixed").parent(".sticky-container").css("margin-bottom","11.25rem"):s.removeClass("is-fixed").parent(".sticky-container").css("margin-bottom","")}))}})),t((function(){let s=t(".block-system-main-block");s.length>0&&t(a).scroll((function(){s.find("div.shortcut-item").each((function(){let e=t(this),i=e.attr("id"),o=Math.ceil(e.offset().top)-80;t(a).scrollTop()>o&&(s.find(".sticky-item").removeClass("active"),s.find(".sticky-item a").removeClass("active"),s.find('.sticky-item a[href="#'+i+'"]').parent().addClass("active"),s.find('.sticky-item a[href="#'+i+'"]').addClass("active"))}))}))})),t(a).bind("hashchange",(function(t){location.reload(!0)})),t(".cp-tabs").find("ul").children('li[role="tab"]').attr("tabindex","0"),t(".tabs--menu-mobile .tab--first a").click((function(s){s.preventDefault(),t(".tab--first").hasClass("active")||(t(".tab--second").removeClass("active"),t(".tab--first").addClass("active"),t(".tab-content--first").removeClass("is-desktop"),t(".tab-content--second").addClass("is-desktop"))})),t(".tabs--menu-mobile .tab--second a").click((function(s){s.preventDefault(),t(".tab--second").hasClass("active")||(t(".tab--first").removeClass("active"),t(".tab--second").addClass("active"),t(".tab-content--second").removeClass("is-desktop"),t(".tab-content--first").addClass("is-desktop"))})),t(".tabs--pagos-online .component__card").click((function(s){s.preventDefault(),t(".tabs--pagos-online .component__card").removeClass("item-active"),t(this).addClass("item-active"),t(".tabs__formas-de-pago #tab-0 .component").removeClass("is-hide-mb"),t(this).hasClass("item-first")&&t(".tabs__formas-de-pago #tab-0 .js-item-second, .tabs__formas-de-pago #tab-0 .js-item-third").addClass("is-hide-mb"),t(this).hasClass("item-second")&&t(".tabs__formas-de-pago #tab-0 .js-item-first, .tabs__formas-de-pago #tab-0 .js-item-third").addClass("is-hide-mb"),t(this).hasClass("item-third")&&t(".tabs__formas-de-pago #tab-0 .js-item-first, .tabs__formas-de-pago #tab-0 .js-item-second").addClass("is-hide-mb")})),t(".tabs--financia .component__card").click((function(s){s.preventDefault(),t(".tabs--financia .component__card").removeClass("item-active"),t(this).addClass("item-active"),t(".tabs__formas-de-pago #tab-1 .component").removeClass("is-hide-mb"),t(this).hasClass("item-first")&&t(".tabs__formas-de-pago #tab-1 .js-item-second, .tabs__formas-de-pago #tab-1 .js-item-third").addClass("is-hide-mb"),t(this).hasClass("item-second")&&t(".tabs__formas-de-pago #tab-1 .js-item-first, .tabs__formas-de-pago #tab-1 .js-item-third").addClass("is-hide-mb"),t(this).hasClass("item-third")&&t(".tabs__formas-de-pago #tab-1 .js-item-first, .tabs__formas-de-pago #tab-1 .js-item-second").addClass("is-hide-mb")})),t(".tabs--otras-formas-pago .component__card").click((function(s){s.preventDefault(),t(".tabs--otras-formas-pago .component__card").removeClass("item-active"),t(this).addClass("item-active"),t(".canales-pago .payment-row:nth-child(2), .canales-pago .payment-row:nth-child(3)").hide(),t(this).hasClass("item-first")&&(t(".canales-pago .payment-row:nth-child(2), .canales-pago .payment-row:nth-child(3)").hide(),t(".canales-pago .payment-row:nth-child(1)").show()),t(this).hasClass("item-second")&&(t(".canales-pago .payment-row:nth-child(1), .canales-pago .payment-row:nth-child(3)").hide(),t(".canales-pago .payment-row:nth-child(2)").show()),t(this).hasClass("item-third")&&(t(".canales-pago .payment-row:nth-child(1), .canales-pago .payment-row:nth-child(2)").hide(),t(".canales-pago .payment-row:nth-child(3)").show())}))}}}(jQuery,Drupal,this,this.document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFicy5jb25maWcuanMiLCJuYW1lcyI6WyIkIiwiRHJ1cGFsIiwid2luZG93IiwiYmVoYXZpb3JzIiwidGFic0pTIiwiYXR0YWNoIiwiY29udGV4dCIsInNldHRpbmdzIiwibm90IiwidGFicyIsImhhc0NsYXNzIiwiZWFjaCIsInJvdyIsInRoaXMiLCJzdGVwcyIsImZpbmQiLCJudW1fc3RlcHMiLCJsZW5ndGgiLCJ2aXNpYmxlX3N0ZXBzIiwic2xpY2UiLCJoaWRlIiwic2hvdyIsImNoaWxkcmVuIiwiY3NzIiwib24iLCJpZF90YWIiLCJhdHRyIiwicGFyZW50cyIsImxvY2F0aW9uIiwicmVwbGFjZSIsImFkZENsYXNzIiwiZml4X3N1YnRhYnNfYXNzaXN0YW5jZXMiLCJzZWxlY3QiLCJ0YWIiLCJ0cmlnZ2VyIiwidHJpZ2dlckhhbmRsZXIiLCJ1bmRlZmluZWQiLCJlIiwiZWwiLCJpZF9ib2R5X3RhYiIsImJvZHlfdGFiIiwianNfc2xpZGVyIiwic2V0VGltZW91dCIsInNsaWNrIiwiYWN0aXZlX3RhYiIsInNQYXJhbSIsInNQYXJhbWV0ZXJOYW1lIiwiaSIsInNVUkxWYXJpYWJsZXMiLCJzZWFyY2giLCJzdWJzdHJpbmciLCJzcGxpdCIsImRlY29kZVVSSUNvbXBvbmVudCIsImdldFVybFBhcmFtZXRlciIsImNsaWNrIiwicHJldmVudERlZmF1bHQiLCJyZW1vdmVDbGFzcyIsInN0ckFuY2xhIiwicG9wIiwib2Zmc2V0IiwidG9wIiwiY29uc29sZSIsImxvZyIsInN0b3AiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiY2hhbmdlIiwicGFyZW50IiwiaWQiLCJ2YWwiLCIkaWRfdGFiIiwic3Vic3RyIiwic3ViX3RhYiIsImluZCIsIm1lbnUiLCJtZW51Rml4ZWRoZWlnaHQiLCJNYXRoIiwiY2VpbCIsInNjcm9sbCIsInBvcDIiLCJzdG9wUHJvcGFnYXRpb24iLCJiaW5kIiwicmVsb2FkIiwialF1ZXJ5IiwiZG9jdW1lbnQiXSwic291cmNlcyI6WyJ0YWJzLmNv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bnQpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgRHJ1cGFsLmJlaGF2aW9ycy50YWJzSlMgPSB7XG4gICAgYXR0YWNoOiBmdW5jdGlvbiAoY29udGV4dCwgc2V0dGluZ3MpIHtcbiAgICAgICQoXCIuY3AtdGFic1wiKS5ub3QoXCIuaXMtc2hvcmN1dCwgLnBvcHVwLW5vLXRhYnNcIikudGFicygpO1xuXG4gICAgICBpZiAoJChcImJvZHlcIikuaGFzQ2xhc3MoXCJqcy1tb2JpbGVcIikpIHtcbiAgICAgICAgLy8gQXNpc3RlbmNpYXMgdmlldyBtb3JlXG4gICAgICAgICQoXCIuc3ViLXRhYl9fcm93XCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGxldCByb3cgPSAkKHRoaXMpLFxuICAgICAgICAgICAgc3RlcHMgPSByb3cuZmluZChcIi5zdWItdGFiX19jb250ZW50IG9sIGxpXCIpLFxuICAgICAgICAgICAgbnVtX3N0ZXBzID0gc3RlcHMubGVuZ3RoLFxuICAgICAgICAgICAgdmlzaWJsZV9zdGVwcyA9IHN0ZXBzLnNsaWNlKDAsIDMpO1xuICAgICAgICAgIGlmIChudW1fc3RlcHMgPiAzKSB7XG4gICAgICAgICAgICBzdGVwcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgJCh0aGlzKS5oaWRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZpc2libGVfc3RlcHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICQodGhpcykuc2hvdygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByb3cuY2hpbGRyZW4oXCIudmlldy1tb3JlXCIpLmNzcyhcInZpc2liaWxpdHlcIiwgXCJ2aXNpYmxlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVGFicyBjb250YWN0XG4gICAgICAgIGlmICgkKFwiLmNvbXBvbmVudF9fdGFicy0tY29udGFjdFwiKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gQWRkIGNsaWNrIGNhcmQgaW4gbW9iaWxlXG4gICAgICAgICAgJChcIi5jb21wb25lbnRfX3RhYnMtLWNvbnRhY3QgLmNwLXRhYnMgLmNvbXBvbmVudF9fY2FyZFwiKS5vbihcbiAgICAgICAgICAgIFwiY2xpY2tcIixcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgbGV0IGlkX3RhYiA9ICQodGhpcykuY2hpbGRyZW4oXCIuY3RhXCIpLmNoaWxkcmVuKFwiYVwiKS5hdHRyKFwiaHJlZlwiKTtcbiAgICAgICAgICAgICAgaWYgKCQodGhpcykucGFyZW50cyhcIi5jcC10YWJzXCIpLmhhc0NsYXNzKFwicG9wdXAtbm8tdGFic1wiKSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKGlkX3RhYik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICQodGhpcykucGFyZW50cyhcIi5jcC10YWJzXCIpLmNoaWxkcmVuKGlkX3RhYikuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsZXQgZml4X3N1YnRhYnNfYXNzaXN0YW5jZXMgPSBmdW5jdGlvbiAoc2VsZWN0LCB0YWIpIHtcbiAgICAgICAgc2VsZWN0XG4gICAgICAgICAgLmZpbmQoXCJvcHRpb246ZXEoMClcIilcbiAgICAgICAgICAuYXR0cihcInNlbGVjdGVkXCIsIFwic2VsZWN0ZWRcIilcbiAgICAgICAgICAudHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgc2VsZWN0LnRyaWdnZXJIYW5kbGVyKFwiZm9jdXNcIik7XG4gICAgICAgIGlmICh0YWIuZmluZChcIi5zdWItdGFic1wiKS50YWJzKFwiaW5zdGFuY2VcIikgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIHRhYi5wYXJlbnRzKFxuICAgICAgICAgICAgICBcIi5ibG9jay10YWJzLWFzc2lzdGFuY2VzLCAuYmxvY2stdGFicy1kb2N1bWVudHMtcmVxdWlyZWRcIlxuICAgICAgICAgICAgKS5sZW5ndGggPiAwXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB0YWIuZmluZChcIi5zdWItdGFic1wiKS50YWJzKFwiZGVzdHJveVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgICQoZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgaWRfdGFiID0gJChcbiAgICAgICAgICAgIFwiI3RhYnMgLmNvbXBvbmVudF9faGVhZGluZyB1bCBsaS51aS1zdGF0ZS1hY3RpdmUgYVwiXG4gICAgICAgICAgKS5hdHRyKFwiaHJlZlwiKSxcbiAgICAgICAgICB0YWIgPSAkKGlkX3RhYiksXG4gICAgICAgICAgc2VsZWN0ID0gdGFiLmZpbmQoXCIuc2VsZWN0LS10YWJzXCIpO1xuXG4gICAgICAgIGZpeF9zdWJ0YWJzX2Fzc2lzdGFuY2VzKHNlbGVjdCwgdGFiKTtcbiAgICAgIH0pO1xuXG4gICAgICAkKFwiLmNwLXRhYnMgdWwgbGkgYVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghKCQodGhpcykuaGFzQ2xhc3MoJ3BvcHVwLW5vLXRhYnMnKSkpIHtcbiAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpLFxuICAgICAgICAgICAgaWRfYm9keV90YWIgPSBlbC5hdHRyKFwiaHJlZlwiKSxcbiAgICAgICAgICAgIGJvZHlfdGFiID0gZWwucGFyZW50cyhcIi5jcC10YWJzXCIpLmNoaWxkcmVuKGlkX2JvZHlfdGFiKSxcbiAgICAgICAgICAgIGpzX3NsaWRlciA9IGJvZHlfdGFiLmZpbmQoXCIuanMtc2xpZGVyLW1vYmlsZVwiKSxcbiAgICAgICAgICAgIHNlbGVjdCA9IGJvZHlfdGFiLmZpbmQoXCIuc2VsZWN0LS10YWJzXCIpO1xuXG4gICAgICAgICAgaWYgKHNlbGVjdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmaXhfc3VidGFic19hc3Npc3RhbmNlcyhzZWxlY3QsICQoaWRfYm9keV90YWIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoanNfc2xpZGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBqc19zbGlkZXIuZmluZChcIi5jb2ctLWl0ZW1zXCIpLnNsaWNrKFwic2V0UG9zaXRpb25cIik7XG4gICAgICAgICAgICB9LCAxMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgbGV0IGdldFVybFBhcmFtZXRlciA9IGZ1bmN0aW9uIChzUGFyYW0pIHtcbiAgICAgICAgbGV0IHNQYWdlVVJMID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSksXG4gICAgICAgICAgc1VSTFZhcmlhYmxlcyA9IHNQYWdlVVJMLnNwbGl0KFwiJlwiKSxcbiAgICAgICAgICBzUGFyYW1ldGVyTmFtZSxcbiAgICAgICAgICBpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc1VSTFZhcmlhYmxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHNQYXJhbWV0ZXJOYW1lID0gc1VSTFZhcmlhYmxlc1tpXS5zcGxpdChcIj1cIik7XG5cbiAgICAgICAgICBpZiAoc1BhcmFtZXRlck5hbWVbMF0gPT09IHNQYXJhbSkge1xuICAgICAgICAgICAgcmV0dXJuIHNQYXJhbWV0ZXJOYW1lWzFdID09PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgPyB0cnVlXG4gICAgICAgICAgICAgIDogZGVjb2RlVVJJQ29tcG9uZW50KHNQYXJhbWV0ZXJOYW1lWzFdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGxldCBhY3RpdmVfdGFiID0gZ2V0VXJsUGFyYW1ldGVyKFwidGFiXCIpO1xuXG4gICAgICBpZiAoYWN0aXZlX3RhYiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICQoJ2FbaHJlZj1cIiN0YWJzLScgKyBhY3RpdmVfdGFiICsgJ1wiXScpLmNsaWNrKCk7XG4gICAgICB9XG5cbiAgICAgICQoXCIuY3AtdGFicy5pcy1zaG9yY3V0IC5ub3JtYWwtdGFiIGFcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICQoXCIuY3AtdGFicy5pcy1zaG9yY3V0IC5ub3JtYWwtdGFiIGFcIikucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgIGxldCBzdHJBbmNsYSA9ICQodGhpcykuYXR0cihcImhyZWZcIik7IC8vaWQgZGVsIGFuY2xhXG5cbiAgICAgICAgbGV0IHBvcCA9ICQoc3RyQW5jbGEpLm9mZnNldCgpLnRvcDtcbiAgICAgICAgY29uc29sZS5sb2cocG9wKTtcbiAgICAgICAgJChcImh0bWwsIGJvZHlcIilcbiAgICAgICAgICAuc3RvcCh0cnVlLCB0cnVlKVxuICAgICAgICAgIC5hbmltYXRlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzY3JvbGxUb3A6ICQoc3RyQW5jbGEpLm9mZnNldCgpLnRvcCAtIDcwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDEwMDBcbiAgICAgICAgICApO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRhYnNcbiAgICAgICQoXCIuc2VsZWN0LS10YWJzXCIpLmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAkKHRoaXMpXG4gICAgICAgICAgICAucGFyZW50KClcbiAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAucGFyZW50KClcbiAgICAgICAgICAgIC5maW5kKFwiLnN1Yi10YWJfX2NvbnRhaW5lclwiKS5sZW5ndGggPiAwXG4gICAgICAgICkge1xuICAgICAgICAgICQodGhpcylcbiAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAucGFyZW50KClcbiAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgLmZpbmQoXCIuc3ViLXRhYl9fY29udGFpbmVyXCIpXG4gICAgICAgICAgICAuaGlkZSgpO1xuICAgICAgICAgIGxldCBpZCA9ICQodGhpcykudmFsKCk7XG4gICAgICAgICAgJChcIiNcIiArIGlkKS5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJChcIi50YWJzXCIpLmhpZGUoKTtcbiAgICAgICAgICAkKFwiI1wiICsgJCh0aGlzKS52YWwoKSkuc2hvdygpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gVGFicyBjb250YWN0XG4gICAgICBpZiAoJChcIi5jb21wb25lbnRfX3RhYnMtLWNvbnRhY3RcIikubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBBZGQgYWN0aXZlIHRhYnMgY29udGFjdFxuICAgICAgICAkKFwiLmNvbXBvbmVudF9fdGFicy0tY29udGFjdCAuY3AtdGFicyBsaVwiKS5yZW1vdmVDbGFzcyhcbiAgICAgICAgICBcInVpLXRhYnMtYWN0aXZlIHVpLXN0YXRlLWFjdGl2ZVwiXG4gICAgICAgICk7XG4gICAgICAgICQoXCIuY29tcG9uZW50X190YWJzLS1jb250YWN0IC5jcC10YWJzIGxpIC5jb21wb25lbnRfX2NhcmQgYVwiKS5jbGljayhcbiAgICAgICAgICBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYoISgkKHRoaXMpLmhhc0NsYXNzKCdwb3B1cC1uby10YWJzJykpKSB7XG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgJCh0aGlzKVxuICAgICAgICAgICAgICAgIC5wYXJlbnRzKFwiLmNvbXBvbmVudF9fdGFicy0tY29udGFjdCAuY3AtdGFicyBsaVwiKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInVpLXRhYnMtYWN0aXZlIHVpLXN0YXRlLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgbGV0ICRpZF90YWIgPSAkKHRoaXMpLmF0dHIoXCJocmVmXCIpO1xuICAgICAgICAgICAgICAkaWRfdGFiID0gJGlkX3RhYi5zdWJzdHIoMSk7XG4gICAgICAgICAgICAgICQodGhpcykucGFyZW50cyhcIi5jcC10YWJzXCIpLmZpbmQoXCIudGFic1wiKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgJCh0aGlzKVxuICAgICAgICAgICAgICAgIC5wYXJlbnRzKFwiLmNwLXRhYnNcIilcbiAgICAgICAgICAgICAgICAuZmluZChcIiNcIiArICRpZF90YWIpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgJChcIi5jb21wb25lbnRfX3RhYnMtLWNvbnRhY3QgLmNwLXRhYnMgLnRhYnMgZm9ybSAjY2xvc2VcIikuY2xpY2soXG4gICAgICAgICAgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cyhcIi50YWJzXCIpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gSGlkZSBzdWJ0YWJzIGlmIG9ubHkgZXhpc3QgMSB0YWIsIHNob3cgYXJyb3dzIG9uIGVudGVycHJpc2UgYXNzaXRhbmNlc1xuICAgICAgJChcIiNzdWItdGFicyAuY29tcG9uZW50X19oZWFkaW5nXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgc3ViX3RhYiA9ICQodGhpcyksXG4gICAgICAgICAgc2VsZWN0ID0gc3ViX3RhYi5maW5kKFwiLnNlbGVjdC0tdGFic1wiKSxcbiAgICAgICAgICBwcm9kdWN0X3N1Yl90YWJzID0gc2VsZWN0LmZpbmQoXCJvcHRpb25cIikubGVuZ3RoO1xuXG4gICAgICAgIGlmIChwcm9kdWN0X3N1Yl90YWJzID09PSAxKSB7XG4gICAgICAgICAgc3ViX3RhYi5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAkKFwiLnN1Yi10YWJfX3JvdyAudmlldy1tb3JlXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBsZXQgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnRzKFwiLnN1Yi10YWJfX3Jvd1wiKTtcbiAgICAgICAgcGFyZW50LmFkZENsYXNzKFwicG9wdXBcIik7XG4gICAgICAgIHBhcmVudC5maW5kKFwiLnN1Yi10YWJfX2hlYWRpbmctaW1nXCIpLmFkZENsYXNzKFwiY2FyZF9faW1nLS1vdmFsXCIpO1xuICAgICAgICBwYXJlbnQuZmluZChcIi5zdWItdGFiX19jb250ZW50IG9sIGxpXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICQodGhpcykuc2hvdygpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICAkKFwiLnN1Yi10YWJfX3JvdyAucG9wdXAtY2xvc2VcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGxldCBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudHMoXCIuc3ViLXRhYl9fcm93XCIpO1xuICAgICAgICBwYXJlbnQuZmluZChcIi5zdWItdGFiX19oZWFkaW5nLWltZ1wiKS5yZW1vdmVDbGFzcyhcImNhcmRfX2ltZy0tb3ZhbFwiKTtcbiAgICAgICAgcGFyZW50LmZpbmQoXCIuc3ViLXRhYl9fY29udGVudCBvbCBsaVwiKS5lYWNoKGZ1bmN0aW9uIChpbmQpIHtcbiAgICAgICAgICBpZiAoaW5kID4gMikge1xuICAgICAgICAgICAgJCh0aGlzKS5oaWRlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcGFyZW50LnJlbW92ZUNsYXNzKFwicG9wdXBcIik7XG4gICAgICB9KTtcblxuICAgICAgJChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIENvbXBvbmVudGUgbWVudXRhYnMgZml4ZWQgc2Nyb2xsIGRldGFsbGUgcHJvZHVjdG9cbiAgICAgICAgbGV0IG1lbnUgPSAkKFwiLmlzLXNob3JjdXQgLm1haW4tbGlua3NcIik7XG4gICAgICAgIGlmIChtZW51Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBsZXQgbWVudUZpeGVkID0gTWF0aC5jZWlsKG1lbnUub2Zmc2V0KCkudG9wKSxcbiAgICAgICAgICAgIG1lbnVGaXhlZGhlaWdodCA9IG1lbnVGaXhlZCAtIDEwO1xuXG4gICAgICAgICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsZXQgd2luZG93SGVpZ2h0ID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuICAgICAgICAgICAgaWYgKHdpbmRvd0hlaWdodCA+IG1lbnVGaXhlZGhlaWdodCkge1xuICAgICAgICAgICAgICBtZW51XG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiZml4ZWRcIilcbiAgICAgICAgICAgICAgICAucGFyZW50KFwiLmNvZy0tbXFcIilcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJpcy1maXhlZFwiKVxuICAgICAgICAgICAgICAgIC5jc3MoXCJtYXJnaW4tYm90dG9tXCIsIFwiNS4yNXJlbVwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1lbnVcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoXCJmaXhlZFwiKVxuICAgICAgICAgICAgICAgIC5wYXJlbnQoXCIuY29nLS1tcVwiKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhcImlzLWZpeGVkXCIpXG4gICAgICAgICAgICAgICAgLmNzcyhcIm1hcmdpbi1ib3R0b21cIiwgXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSGlnaGxpZ2h0IGFjdHVhbCBjb21wb25lbnQgbGluayBvbiBzY3JvbGxcbiAgICAgICAgbGV0IG1lbnUgPSAkKFwiLmlzLXNob3JjdXRcIik7XG4gICAgICAgIGlmIChtZW51Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG1lbnUuZmluZChcImRpdi50YWJzXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgIGlkID0gZWwuYXR0cihcImlkXCIpLFxuICAgICAgICAgICAgICAgIG1lbnVGaXhlZCA9IE1hdGguY2VpbChlbC5vZmZzZXQoKS50b3ApIC0gODAsXG4gICAgICAgICAgICAgICAgbWVudUZpeGVkaGVpZ2h0ID0gbWVudUZpeGVkLFxuICAgICAgICAgICAgICAgIHdpbmRvd0hlaWdodCA9ICQod2luZG93KS5zY3JvbGxUb3AoKTtcblxuICAgICAgICAgICAgICBpZiAod2luZG93SGVpZ2h0ID4gbWVudUZpeGVkaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgbWVudS5maW5kKFwiYS5hY3RpdmVcIikucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgbWVudS5maW5kKCdhW2hyZWY9XCIjJyArIGlkICsgJ1wiXScpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgICQoXCIuY29tcG9uZW50X19zaG9yY3V0cyAuc3RpY2t5LWl0ZW0gYVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgJChcbiAgICAgICAgICBcIi5jb21wb25lbnRfX3Nob3JjdXRzIC5zdGlja3ktaXRlbSwgLmNvbXBvbmVudF9fc2hvcmN1dHMgLnN0aWNreS1pdGVtIGFcIlxuICAgICAgICApLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICBsZXQgc3RyQW5jbGEgPSAkKHRoaXMpLmF0dHIoXCJocmVmXCIpOyAvL2lkIGRlbCBhbmNsYVxuXG4gICAgICAgIGxldCBwb3AyID0gJChzdHJBbmNsYSkub2Zmc2V0KCkudG9wO1xuICAgICAgICBjb25zb2xlLmxvZyhwb3AyKTtcbiAgICAgICAgJChcImh0bWwsIGJvZHlcIilcbiAgICAgICAgICAuc3RvcCh0cnVlLCB0cnVlKVxuICAgICAgICAgIC5hbmltYXRlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzY3JvbGxUb3A6ICQoc3RyQW5jbGEpLm9mZnNldCgpLnRvcCAtIDcwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDEwMDBcbiAgICAgICAgICApO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgICQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBDb21wb25lbnRlIG1lbnV0YWJzIGZpeGVkIHNjcm9sbCBkZXRhbGxlIHByb2R1Y3RvXG4gICAgICAgIGxldCBtZW51ID0gJChcIi5jb21wb25lbnRfX3Nob3JjdXRzIC5zdGlja3ktd3JhcHBlclwiKTtcbiAgICAgICAgaWYgKG1lbnUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGxldCBtZW51Rml4ZWQgPSBNYXRoLmNlaWwobWVudS5vZmZzZXQoKS50b3ApLFxuICAgICAgICAgICAgbWVudUZpeGVkaGVpZ2h0ID0gbWVudUZpeGVkICsgMTY7XG5cbiAgICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCB3aW5kb3dIZWlnaHQgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICBpZiAod2luZG93SGVpZ2h0ID4gbWVudUZpeGVkaGVpZ2h0KSB7XG4gICAgICAgICAgICAgIG1lbnVcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJpcy1maXhlZFwiKVxuICAgICAgICAgICAgICAgIC5wYXJlbnQoXCIuc3RpY2t5LWNvbnRhaW5lclwiKVxuICAgICAgICAgICAgICAgIC5jc3MoXCJtYXJnaW4tYm90dG9tXCIsIFwiMTEuMjVyZW1cIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtZW51XG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKFwiaXMtZml4ZWRcIilcbiAgICAgICAgICAgICAgICAucGFyZW50KFwiLnN0aWNreS1jb250YWluZXJcIilcbiAgICAgICAgICAgICAgICAuY3NzKFwibWFyZ2luLWJvdHRvbVwiLCBcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgICQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBIaWdobGlnaHQgYWN0dWFsIGNvbXBvbmVudCBsaW5rIG9uIHNjcm9sbFxuICAgICAgICBsZXQgbWVudSA9ICQoXCIuYmxvY2stc3lzdGVtLW1haW4tYmxvY2tcIik7XG4gICAgICAgIGlmIChtZW51Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG1lbnUuZmluZChcImRpdi5zaG9ydGN1dC1pdGVtXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgIGlkID0gZWwuYXR0cihcImlkXCIpLFxuICAgICAgICAgICAgICAgIG1lbnVGaXhlZCA9IE1hdGguY2VpbChlbC5vZmZzZXQoKS50b3ApIC0gODAsXG4gICAgICAgICAgICAgICAgbWVudUZpeGVkaGVpZ2h0ID0gbWVudUZpeGVkLFxuICAgICAgICAgICAgICAgIHdpbmRvd0hlaWdodCA9ICQod2luZG93KS5zY3JvbGxUb3AoKTtcblxuICAgICAgICAgICAgICBpZiAod2luZG93SGVpZ2h0ID4gbWVudUZpeGVkaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgbWVudS5maW5kKFwiLnN0aWNreS1pdGVtXCIpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIG1lbnUuZmluZChcIi5zdGlja3ktaXRlbSBhXCIpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIG1lbnVcbiAgICAgICAgICAgICAgICAgIC5maW5kKCcuc3RpY2t5LWl0ZW0gYVtocmVmPVwiIycgKyBpZCArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgbWVudVxuICAgICAgICAgICAgICAgICAgLmZpbmQoJy5zdGlja3ktaXRlbSBhW2hyZWY9XCIjJyArIGlkICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgJCh3aW5kb3cpLmJpbmQoXCJoYXNoY2hhbmdlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGxvY2F0aW9uLnJlbG9hZCh0cnVlKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZ3JlZ2FuZG8gdGFiaW5kZXggYSBjYWRhIHRhYlxuICAgICAgJChcIi5jcC10YWJzXCIpLmZpbmQoXCJ1bFwiKS5jaGlsZHJlbignbGlbcm9sZT1cInRhYlwiXScpLmF0dHIoXCJ0YWJpbmRleFwiLCBcIjBcIik7XG5cbiAgICAgIC8vbWVudSBtb2JpbGVcbiAgICAgICQoXCIudGFicy0tbWVudS1tb2JpbGUgLnRhYi0tZmlyc3QgYVwiKS5jbGljayhmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmICghJChcIi50YWItLWZpcnN0XCIpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XG4gICAgICAgICAgJChcIi50YWItLXNlY29uZFwiKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgICAgICAkKFwiLnRhYi0tZmlyc3RcIikuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG5cbiAgICAgICAgICAkKFwiLnRhYi1jb250ZW50LS1maXJzdFwiKS5yZW1vdmVDbGFzcyhcImlzLWRlc2t0b3BcIik7XG4gICAgICAgICAgJChcIi50YWItY29udGVudC0tc2Vjb25kXCIpLmFkZENsYXNzKFwiaXMtZGVza3RvcFwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgICQoXCIudGFicy0tbWVudS1tb2JpbGUgLnRhYi0tc2Vjb25kIGFcIikuY2xpY2soZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoISQoXCIudGFiLS1zZWNvbmRcIikuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcbiAgICAgICAgICAkKFwiLnRhYi0tZmlyc3RcIikucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgJChcIi50YWItLXNlY29uZFwiKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuICAgICAgICAgICQoXCIudGFiLWNvbnRlbnQtLXNlY29uZFwiKS5yZW1vdmVDbGFzcyhcImlzLWRlc2t0b3BcIik7XG4gICAgICAgICAgJChcIi50YWItY29udGVudC0tZmlyc3RcIikuYWRkQ2xhc3MoXCJpcy1kZXNrdG9wXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gdGFicyBtb2JpbGUgZm9ybWFzIHBhZ29cbiAgICAgICQoXCIudGFicy0tcGFnb3Mtb25saW5lIC5jb21wb25lbnRfX2NhcmRcIikuY2xpY2soZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkKFwiLnRhYnMtLXBhZ29zLW9ubGluZSAuY29tcG9uZW50X19jYXJkXCIpLnJlbW92ZUNsYXNzKFwiaXRlbS1hY3RpdmVcIik7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJpdGVtLWFjdGl2ZVwiKTtcblxuICAgICAgICAkKFwiLnRhYnNfX2Zvcm1hcy1kZS1wYWdvICN0YWItMCAuY29tcG9uZW50XCIpLnJlbW92ZUNsYXNzKFwiaXMtaGlkZS1tYlwiKTtcbiAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJpdGVtLWZpcnN0XCIpKSB7XG4gICAgICAgICAgJChcbiAgICAgICAgICAgIFwiLnRhYnNfX2Zvcm1hcy1kZS1wYWdvICN0YWItMCAuanMtaXRlbS1zZWNvbmQsIC50YWJzX19mb3JtYXMtZGUtcGFnbyAjdGFiLTAgLmpzLWl0ZW0tdGhpcmRcIlxuICAgICAgICAgICkuYWRkQ2xhc3MoXCJpcy1oaWRlLW1iXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiaXRlbS1zZWNvbmRcIikpIHtcbiAgICAgICAgICAkKFxuICAgICAgICAgICAgXCIudGFic19fZm9ybWFzLWRlLXBhZ28gI3RhYi0wIC5qcy1pdGVtLWZpcnN0LCAudGFic19fZm9ybWFzLWRlLXBhZ28gI3RhYi0wIC5qcy1pdGVtLXRoaXJkXCJcbiAgICAgICAgICApLmFkZENsYXNzKFwiaXMtaGlkZS1tYlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcIml0ZW0tdGhpcmRcIikpIHtcbiAgICAgICAgICAkKFxuICAgICAgICAgICAgXCIudGFic19fZm9ybWFzLWRlLXBhZ28gI3RhYi0wIC5qcy1pdGVtLWZpcnN0LCAudGFic19fZm9ybWFzLWRlLXBhZ28gI3RhYi0wIC5qcy1pdGVtLXNlY29uZFwiXG4gICAgICAgICAgKS5hZGRDbGFzcyhcImlzLWhpZGUtbWJcIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAkKFwiLnRhYnMtLWZpbmFuY2lhIC5jb21wb25lbnRfX2NhcmRcIikuY2xpY2soZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkKFwiLnRhYnMtLWZpbmFuY2lhIC5jb21wb25lbnRfX2NhcmRcIikucmVtb3ZlQ2xhc3MoXCJpdGVtLWFjdGl2ZVwiKTtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcIml0ZW0tYWN0aXZlXCIpO1xuXG4gICAgICAgICQoXCIudGFic19fZm9ybWFzLWRlLXBhZ28gI3RhYi0xIC5jb21wb25lbnRcIikucmVtb3ZlQ2xhc3MoXCJpcy1oaWRlLW1iXCIpO1xuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcIml0ZW0tZmlyc3RcIikpIHtcbiAgICAgICAgICAkKFxuICAgICAgICAgICAgXCIudGFic19fZm9ybWFzLWRlLXBhZ28gI3RhYi0xIC5qcy1pdGVtLXNlY29uZCwgLnRhYnNfX2Zvcm1hcy1kZS1wYWdvICN0YWItMSAuanMtaXRlbS10aGlyZFwiXG4gICAgICAgICAgKS5hZGRDbGFzcyhcImlzLWhpZGUtbWJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJpdGVtLXNlY29uZFwiKSkge1xuICAgICAgICAgICQoXG4gICAgICAgICAgICBcIi50YWJzX19mb3JtYXMtZGUtcGFnbyAjdGFiLTEgLmpzLWl0ZW0tZmlyc3QsIC50YWJzX19mb3JtYXMtZGUtcGFnbyAjdGFiLTEgLmpzLWl0ZW0tdGhpcmRcIlxuICAgICAgICAgICkuYWRkQ2xhc3MoXCJpcy1oaWRlLW1iXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiaXRlbS10aGlyZFwiKSkge1xuICAgICAgICAgICQoXG4gICAgICAgICAgICBcIi50YWJzX19mb3JtYXMtZGUtcGFnbyAjdGFiLTEgLmpzLWl0ZW0tZmlyc3QsIC50YWJzX19mb3JtYXMtZGUtcGFnbyAjdGFiLTEgLmpzLWl0ZW0tc2Vjb25kXCJcbiAgICAgICAgICApLmFkZENsYXNzKFwiaXMtaGlkZS1tYlwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgICQoXCIudGFicy0tb3RyYXMtZm9ybWFzLXBhZ28gLmNvbXBvbmVudF9fY2FyZFwiKS5jbGljayhmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICQoXCIudGFicy0tb3RyYXMtZm9ybWFzLXBhZ28gLmNvbXBvbmVudF9fY2FyZFwiKS5yZW1vdmVDbGFzcyhcbiAgICAgICAgICBcIml0ZW0tYWN0aXZlXCJcbiAgICAgICAgKTtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcIml0ZW0tYWN0aXZlXCIpO1xuXG4gICAgICAgICQoXG4gICAgICAgICAgXCIuY2FuYWxlcy1wYWdvIC5wYXltZW50LXJvdzpudGgtY2hpbGQoMiksIC5jYW5hbGVzLXBhZ28gLnBheW1lbnQtcm93Om50aC1jaGlsZCgzKVwiXG4gICAgICAgICkuaGlkZSgpO1xuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcIml0ZW0tZmlyc3RcIikpIHtcbiAgICAgICAgICAkKFxuICAgICAgICAgICAgXCIuY2FuYWxlcy1wYWdvIC5wYXltZW50LXJvdzpudGgtY2hpbGQoMiksIC5jYW5hbGVzLXBhZ28gLnBheW1lbnQtcm93Om50aC1jaGlsZCgzKVwiXG4gICAgICAgICAgKS5oaWRlKCk7XG4gICAgICAgICAgJChcIi5jYW5hbGVzLXBhZ28gLnBheW1lbnQtcm93Om50aC1jaGlsZCgxKVwiKS5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoXCJpdGVtLXNlY29uZFwiKSkge1xuICAgICAgICAgICQoXG4gICAgICAgICAgICBcIi5jYW5hbGVzLXBhZ28gLnBheW1lbnQtcm93Om50aC1jaGlsZCgxKSwgLmNhbmFsZXMtcGFnbyAucGF5bWVudC1yb3c6bnRoLWNoaWxkKDMpXCJcbiAgICAgICAgICApLmhpZGUoKTtcbiAgICAgICAgICAkKFwiLmNhbmFsZXMtcGFnbyAucGF5bWVudC1yb3c6bnRoLWNoaWxkKDIpXCIpLnNob3coKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcIml0ZW0tdGhpcmRcIikpIHtcbiAgICAgICAgICAkKFxuICAgICAgICAgICAgXCIuY2FuYWxlcy1wYWdvIC5wYXltZW50LXJvdzpudGgtY2hpbGQoMSksIC5jYW5hbGVzLXBhZ28gLnBheW1lbnQtcm93Om50aC1jaGlsZCgyKVwiXG4gICAgICAgICAgKS5oaWRlKCk7XG4gICAgICAgICAgJChcIi5jYW5hbGVzLXBhZ28gLnBheW1lbnQtcm93Om50aC1jaGlsZCgzKVwiKS5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gIH07XG59KShqUXVlcnksIERydXBhbCwgdGhpcywgdGhpcy5kb2N1bWVudCk7XG4iXX0=
